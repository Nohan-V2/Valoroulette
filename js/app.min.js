const $btnSelectAll=document.querySelector(".btn-select-all");const $btnRoll=document.querySelector(".btn-roll");const $btnDeselectAll=document.querySelector(".btn-deselect-all");const $roleButtons={duelist:document.querySelector(".duelist"),initiator:document.querySelector(".initiator"),controller:document.querySelector(".controller"),sentinel:document.querySelector(".sentinel")};const $namePersonSelected=document.querySelector(".name-person-selected");const $agentsList=document.querySelector(".agents-list");const $messageAllAgentsLocked=document.querySelector(".message-all-agents-locked");let lastSelectedAgentName=null;let agentCards=[];const resetSelected=()=>{document.querySelectorAll(".agent-card").forEach(agentCard=>{agentCard.classList.remove("selected")});$namePersonSelected.textContent="Aucun";$namePersonSelected.classList.add("invisible")};const resetSelection=()=>{document.querySelectorAll(".agent-card").forEach(agentCard=>{const $agentImg=agentCard.querySelector(".agent-img");const $lockIcon=agentCard.querySelector(".lock-icon");$agentImg.classList.remove("locked","not-selected");$lockIcon.style.display="none"});resetSelected();lastSelectedAgentName=null};const checkAllAgentsLocked=()=>{const allAgents=document.querySelectorAll(".agent-img");const allLocked=Array.from(allAgents).every(agent=>agent.classList.contains("locked"));$messageAllAgentsLocked.classList.toggle("hidden",!allLocked)};const handleRoleFilter=roleName=>{resetSelected();agentCards.forEach(card=>{const $agentImg=card.element.querySelector(".agent-img");const $lockIcon=card.element.querySelector(".lock-icon");if(card.role===roleName){$agentImg.classList.remove("locked","not-selected");$lockIcon.style.display="none"}else{$agentImg.classList.add("locked");$lockIcon.style.display="block"}});checkAllAgentsLocked()};const selectRandomAgent=()=>{const unlockedAgents=document.querySelectorAll(".agent-card .agent-img:not(.locked)");let availableAgents=Array.from(unlockedAgents);if(lastSelectedAgentName&&availableAgents.length>1){availableAgents=availableAgents.filter(agentImg=>agentImg.alt!==lastSelectedAgentName)}if(availableAgents.length===0){console.log("Aucun agent disponible pour la sÃ©lection");return}const randomIndex=Math.floor(Math.random()*availableAgents.length);const selectedAgentImg=availableAgents[randomIndex];const selectedAgentCard=selectedAgentImg.closest(".agent-card");lastSelectedAgentName=selectedAgentImg.alt;document.querySelectorAll(".agent-card").forEach(agentCard=>{const $agentImg=agentCard.querySelector(".agent-img");$agentImg.classList.add("not-selected");agentCard.classList.remove("selected")});selectedAgentImg.classList.remove("not-selected");selectedAgentCard.classList.add("selected");$namePersonSelected.textContent=lastSelectedAgentName;$namePersonSelected.classList.remove("invisible")};async function loadAgents(){try{const response=await fetch("https://valorant-api.com/v1/agents");const data=await response.json();data.data.forEach(agent=>{if(agent.isPlayableCharacter){const $agentCard=document.createElement("li");$agentCard.classList.add("agent-card");const $agentImg=document.createElement("img");$agentImg.classList.add("agent-img");$agentImg.alt=agent.displayName;$agentImg.src=agent.displayIcon;$agentCard.appendChild($agentImg);const $lockIcon=document.createElement("img");$lockIcon.classList.add("lock-icon");$lockIcon.src="assets/img/lock.svg";$agentCard.appendChild($lockIcon);$agentsList.appendChild($agentCard);agentCards.push({element:$agentCard,role:agent.role?.displayName||null,name:agent.displayName});$agentCard.addEventListener("click",()=>{$agentImg.classList.toggle("locked");$lockIcon.style.display=$agentImg.classList.contains("locked")?"block":"none";checkAllAgentsLocked()})}});$btnSelectAll.addEventListener("click",()=>{resetSelected();agentCards.forEach(card=>{const $agentImg=card.element.querySelector(".agent-img");const $lockIcon=card.element.querySelector(".lock-icon");$agentImg.classList.remove("locked","not-selected");$lockIcon.style.display="none"});checkAllAgentsLocked()});$btnDeselectAll.addEventListener("click",()=>{resetSelected();agentCards.forEach(card=>{const $agentImg=card.element.querySelector(".agent-img");const $lockIcon=card.element.querySelector(".lock-icon");$agentImg.classList.add("locked");$agentImg.classList.remove("not-selected");$lockIcon.style.display="block"});checkAllAgentsLocked()});$btnRoll.addEventListener("click",selectRandomAgent);$roleButtons.duelist.addEventListener("click",()=>{handleRoleFilter("Duelist")});$roleButtons.initiator.addEventListener("click",()=>{handleRoleFilter("Initiator")});$roleButtons.controller.addEventListener("click",()=>{handleRoleFilter("Controller")});$roleButtons.sentinel.addEventListener("click",()=>{handleRoleFilter("Sentinel")});checkAllAgentsLocked()}catch(error){console.error("Erreur:",error)}}loadAgents();